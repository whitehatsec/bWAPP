# PHP
# Test and package your PHP project.
# Add steps that run tests, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/php

trigger:
- master

pool:
  vmImage: ubuntu-latest

variables:
  phpVersion: 7.2

#docker build -t tiredful .
#docker run -p 8000:8000 --name tiredful -it tiredful



steps:
- task: Docker@2
  inputs:
    command: 'build'
    Dockerfile: '**/Dockerfile'
    arguments: '-t bwapp'
  displayName: 'Build docker image'

- script: |
    docker run -d -p 3005:80 bwapp
  

#- script: |
#    wget https://github.com/whitehatsec/vantage-prevent-distributions/releases/latest/download/VantagePrevent.deb          
#    sudo apt-get install -f ./VantagePrevent.deb
#    sudo dast-attacker-cli -init -license-key=11dbc457-356c-4fde-a377-f7408300abce  
#    sudo dast-attacker-cli -output-json=results.json -output-html=results.html .scan/*.har
#  displayName: 'Install Prevent'

#- script: composer install --no-interaction --prefer-dist
#  displayName: 'composer install'
